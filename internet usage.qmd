---
title: "Comprehensive Analysis of Internet Usage Patterns Across European Regions and Countries"
date: 2024-01-14
author: "AGARONYAN Arina and JAIN Khushi"
format: 
  wordcount-html: 
    echo: false 
  html: 
    echo: false 
    toc: true
    toc_depth: 2
    title-block-banner: true
  pdf: 
    echo: false
    toc: true
    toc_depth: 2
    number-sections: true
    colorlinks: true
---

```{r}
#| message: false
library(here)
here::i_am("G11-Internet-Usage.Rproj")
library(vroom)
library(dplyr)
library(tidyr)
library(tidyverse)
library(ggplot2)
library(knitr)
theme_set(theme_bw())
library(sf)
library(eurostat)
library(giscoR)
```

# Research Question

**Exploring Internet Usage Patterns: A Comprehensive Analysis across European Regions and Countries**

The objective of this research is to conduct a thorough analysis of internet usage patterns across Europe, with a focus on individuals' behaviour related to seeking health information, online learning, music streaming, and the impact of age, gender, and employment status. The study also encompasses an examination of internet access at both regional and national levels, as well as broadband internet coverage access and speeds over time.

The research will also delve into other variables related to internet usage. The data will be processed to facilitate a detailed examination of specific internet activities across individual categories and locations. This comprehensive approach aims to provide a nuanced understanding of internet usage patterns in the European context.

```{r}
#| message: false
#| warning: false
co_usage <- vroom(here("data", "EuroStat-full-internet-use.csv"))
co_broadband <- vroom(here("data", "EuroStat-broadband-coverage-speed.csv"))
co_house_access <- vroom(here("data", "EuroStat-household-internet-access.csv"))
reg_broadband <- vroom(here("data", "OECD-regional-internet-broadband.csv"))
reg_int_access <- vroom(here("data", "EuroStat-regional-internet-access.csv"))
reg_int_use <- vroom(here("data", "EuroStat-regional-internet-usage.csv"))
reg_shopping <- vroom(here("data", "EuroStat-regional-goods-services.csv"))
```

# Data Sets Description

## Data Sources

***Region-Level Data***

[Households that have internet access at home by NUTS 2 regions:]{.underline}

The access of households to internet is measured as percentage of households where any member of the household has the possibility to access the internet from home. This data is produced through an annual survey which is updated each year to reflect the evolving situation of information and communication technologies.

[Individuals who ordered goods or services over the internet for private use in the last year by NUTS 2 regions:]{.underline}

Persons who bought or ordered goods or services (i.e. food, groceries, household goods, films, music, books, magazines, newspapers, clothes, sports goods, computer software or hardware, electronic equipment, shares, financial services, insurances, travel or holiday accommodation, tickets, lotteries or betting and other) over the internet during the last year.

[Individuals regularly using the internet by NUTS 2 regions:]{.underline}

Regular users of the internet are persons who use the internet on average at least once a week, every day or almost every day. The ICT survey covers those households having at least one member in the age group 16 to 74 years old. Internet access of households refers to the percentage of households that have an internet access, so that anyone in the household could use the internet.

***Region and Country-Level Data:***

[Regional Social and Environmental indicators: Internet broadband access:]{.underline}

Share of households with internet broadband access (in % of total households). The data is available for many countries; we selected 29 European countries and their regions. The OECD has classified two levels of geographic units within each country: large regions (territorial level 2 or TL2), and small regions (territorial level 3 or TL3).

***Country-Level Data***

[Individuals - internet activities:]{.underline}

This is a custom dataset, with all the relevant variables selected and available through the link. Consists of yearly data, covering per country purpose for usage of internet. The questionnaire for the data is updated each year to reflect the evolving situation of information and communication technologies. Indicators from the survey are used for benchmarking purposes. The indicators provided are drawn from the following list of subjects: access to and use of ICTs by individuals and/or in households, use of the internet and other electronic networks for different purposes (e-commerce for example) by individuals and/or in households, barriers to the use of ICT and the Internet, perceived effects of ICT usage on individuals and/or on households, use of ICT by individuals to exchange information and services with governments and public administrations (e-government), access to and use of technologies enabling connection to the Internet or other networks from anywhere at any time (ubiquitous connectivity).

[Broadband internet coverage by speed]{.underline}:

Total country coverage by different download speed categories. The indicators measure the coverage by broadband internet as a % of households. Data is collected in a survey of National Regulatory Authorities and operators on a regional, NUTS3 level. The provided data is then combined to show total country coverage by different broadband technologies and download speed categories, taking into account operator and technology overlaps.

[Level of internet access - households]{.underline}:

Percentage of households who have internet access at home. The survey collects data of internet users, individuals who have used the internet in the three months prior to the survey. Regular internet users are individuals who used the internet, on average, at least once a week in the three months prior to the survey. All forms of internet use are included. The population considered is aged 16 to 74.

## Basic Information of Raw Data files

```{r function_table}
raw_data_table <- function(.x, name) {
  raw_data <- .x |> summarise(
    Dataset = name,
    Rows = nrow(.x),
    Columns = ncol(.x),
    `Number of Years Observed` = 
      n_distinct(select(.x, starts_with("TIME"))),
    `Number of Regions/Countries` = 
      n_distinct(select(.x, contains("geo") | contains("Region")))
  )
  return(raw_data)
}

#list of raw data names

datasets <- list(
  reg_broadband = "Broadband Access - Region",
  reg_int_access = "Internet Access - NUTS 2 Region",
  reg_int_use = "Regular Internet Use - NUTS 2 Region",
  reg_shopping = "Internet use for buying Goods and Services - NUTS 2 Region",
  co_usage = "Internet Usage - Country",
  co_broadband = "Broadband Access - Country",
  co_house_access = "Internet Access - Country"
)

# data frame to store the combined raw data table
combined_raw_data_table <- data.frame()

#Loop
for (dataset in names(datasets)) {
  dataset_name <- datasets[[dataset]]
  dataset_raw_data <- get(dataset) |> raw_data_table(name = dataset_name)
  combined_raw_data_table <- bind_rows(combined_raw_data_table, dataset_raw_data)
}
```

```{r files_table}
kable(combined_raw_data_table, 
      caption = "Raw Data Table for Datasets", align = "cc")
```

### Variable Description

```{r function_region_ID}
reformatting_region <- function(int_df) {
region_ids <- int_df |>
  distinct(geo, `Geopolitical entity (reporting)`) |>
  rename(REG_ID = geo, 
         Region = `Geopolitical entity (reporting)`)
}
```

**Region-Level Data Description**

We possess region-level data from OECD and Eurostat, where the Region IDs are specified using country initials and a unique number allotted to each region.

[NUTS 2 Regions Eurostat]{.underline}

```{r}
kable(head(reg_int_use_reg_id <- reg_int_use |> 
             reformatting_region()), 
      caption = "First 6 rows of Eurostat Region IDs and Names")
```

[Territory level and Region ID OECD]{.underline}

```{r}
kable(head(reg_id_reg_broadband <- reg_broadband |>
  distinct(Region, REG_ID, TL) |>
  group_by(REG_ID) |>
  relocate(REG_ID)),
  caption = "First 6 rows of OECD Region IDs and Names")
```

Where Territorial Level 1 represents a country, and 2 represents states and regions.

This following table establishes the connection between OECD regions and NUTS 2 regions.

```{r}
kable(head(reg_ids <- reg_id_reg_broadband |>
             select(-TL) |>
             inner_join(reg_int_use_reg_id, 
                        by = join_by(REG_ID), 
                        suffix = c("_OECD", "_Eurostat"))), 
           caption = "First 6 rows of OECD and Eurostat Region IDs and Names")
```

**Country-Level Data Description**

The country-level data is comprised of 15 variables analysing various types of internet usage, such as seeking health information, online learning, and music streaming. The following tables represent the country codes, indicator codes and associated information.

```{r}
kable(country_ids <- co_broadband |>
  distinct(geo, `Geopolitical entity (reporting)`) |>
  rename(REG_ID = geo, 
         Country = `Geopolitical entity (reporting)`),
  caption = "Eurostat Country codes and names",
  align = "cc")
```

```{r}
kable(
  indicator_id_co_usage <- co_usage |>
  distinct(indic_is, `Information society indicator`) |>
  separate_wider_delim(`Information society indicator`, ":", names = c(NA, "Information society indicator")) |>
  group_by(indic_is),
  caption = "Internet usage variables: indicator codes and names",
  align = "lr")
```

Our internet usage data is categorised based on individuals' different ages, sexes, and employment statuses.

```{r}
kable(
individual_type_co_usage <- co_usage |>
  distinct(ind_type, `Individual type`) |>
  group_by(ind_type),
caption = "Internet usage variables: individual type codes and names",
align = "lr"
)
```

```{r}
kable(broadband_speed_id <- co_broadband |>
  distinct(inet_spd, `Internet speed`),
  caption = "Broadband speed: codes and description",
  align = "lr")
```

```{r single_value_function}
single_value <- function(my_var) {
  (my_var |> unique() |> length()) ==1
}
```

```{r cleaning_start}
reg_broadband <- reg_broadband |>
  select(-where(anyNA), -where(single_value), -TIME, 
         -TL, -`Territory level and Typology`, -Region)
```

```{r regional_basic_function}
reformatting <- function(int_df) {
int <- int_df |>
  select(-where(single_value), 
         -`Observation status (Flag)`, 
         -OBS_FLAG) |>
  select(!where(\(.x) all(is.na(.x)))) |>
  rename(REG_ID = geo, 
         Region = `Geopolitical entity (reporting)`,
         Year = TIME_PERIOD,
         Value = OBS_VALUE) |>
  select(-Region)
}
```

```{r}
reg_int_use <- reg_int_use |> reformatting()
reg_int_access <- reg_int_access |> reformatting()
reg_shopping <- reg_shopping |> reformatting()
```

```{r}
co_house_access <- co_house_access |> reformatting()
```

```{r}
co_broadband <- co_broadband |> reformatting()
co_broadband <- co_broadband |>
  select(-`Internet speed`) |>
  pivot_wider(names_from = inet_spd, values_from = Value)
```

```{r internet_usage_split_function}
reformatting_full <- function(int_df) {
  
country_ids <- int_df |>
  distinct(geo, `Geopolitical entity (reporting)`) |>
  rename(REG_ID = geo, Region = `Geopolitical entity (reporting)`)

indicators <- int_df |>
  distinct(indic_is, `Information society indicator`) |>
  separate_wider_delim(`Information society indicator`, ":", names = c(NA, "Information society indicator"))

individuals <- int_df |>
  distinct(ind_type, `Individual type`) 

int_full <- int_df |> reformatting()
int_full <- int_full |>
  select(-`Information society indicator`, -`Individual type`)

int_wide <- int_full |>
  pivot_wider(names_from = ind_type, values_from = Value)

int_female <- int_wide |>
  select(indic_is, REG_ID, Year, starts_with("F_"))

int_male <- int_wide |>
  select(indic_is, REG_ID, Year, starts_with("M_"))

int_emp <- int_wide |>
  select(indic_is, REG_ID, Year, RETIR_OTHER, SAL_SELF_FAM, STUD, UNE)

list(country_ids = country_ids,
     indicators = indicators,
     individuals = individuals,
     internet = int_full, 
     int_wide = int_wide,
     int_female = int_female,
     int_male = int_male,
     int_emp = int_emp)
}
```

```{r cleaning_end}
co_usage <- co_usage |> reformatting_full()
```

# Data Analysis

## Internet access

### Country Level

Over the past years, there has been a notable positive trend in global connectivity, with a substantial improvement in internet accessibility across the majority of countries. We can see that of most of these countries that over 85% of households gained access to internet. This progress underscores the widespread efforts and advancements in infrastructure, technology, and digital literacy initiatives on a global scale.

In Luxembourg, Netherlands and Denmark, 98% of households had internet access in 2022. The increament in Greece was of 50 percentage points, from 53.58% in 2012 to 85.49 % in 2022.

```{r Top 5 and Below 5 Countries}
rearranged_country <- co_house_access %>%
  filter(Year %in% c("2012", "2022"), REG_ID %in% c("LU", "NL", "DK", "FI", "SE", "IE", "AT", "BE", "FR", "BG", "EL", "RO", "ME", "LT", "PT", "CY", "IT")) %>%
  inner_join(country_ids, by = "REG_ID") %>%
  mutate(Rank = rank(-Value)) %>%
  arrange(Rank) %>%
  select(-Rank)
```

```{r Comparison Graph}
ggplot(rearranged_country, aes(x = fct_rev(fct_inorder(Country)), 
                               y = Value, fill = as.factor(Year))) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8), 
           width = 0.7, color = "white") +
  labs(title = "Comparison of Countries in 2022 and 2012",
       x = "Country",
       y = "% Households with Internet Access") +
  scale_fill_manual(values = c("2012" = "#3182bd", "2022" = "#de2d26"), 
                    name = "Year") +
  theme_minimal() +
  coord_flip()
```

### Regional level

This plot visualises the trend of internet access in various regions over time, offering a dynamic perspective on the changing landscape of household internet access. There is a general overall increase across all European regions over time.

```{r}
#| message: false
map_reg <- get_eurostat_geospatial(resolution = 10, 
                        nuts_level = 2, 
                        year = 2016,
                        crs = 3035)
map_reg <- map_reg |>
  select(id, NAME_LATN) |>
  rename(REG_ID = id) 
```

```{r}
reg_int_access |>
  mutate(Year = factor(Year)) |>
  ggplot(aes(x= Year, y=Value, group = REG_ID))+
  geom_line(linewidth=0.05) +
  labs(
    title = "Internet Access in Regions over Time",
    x = "Year",
    y = "% of Households with Internet Access"
  )
```

The maps compare internet access in 2014 and 2022 in the NUTS 2 Regions. 50% improvement in the North West Belgium. In Romania, regions such as South-Muntenia, South-West Oltenia, North-East and Center, had a more than 35% improvement.

::: {layout-ncol="2"}
::: {#2014}
```{r}
int_acc_map_reg <- reg_int_access |>
  filter(Year=="2014") |>
  full_join(map_reg, by=join_by(REG_ID)) |>
  st_as_sf()
```

```{r regional_internet_access_map_2014}
int_acc_map_reg |>
  ggplot(aes(fill = Value)) +
  geom_sf(size = 0.2) +
  scale_fill_distiller(
    direction = 1, 
    name = "%",
    na.value = "gray80",
    limits=c(40, 100)) + 
  scale_x_continuous(limits = c(2500000, 7000000)) +
  scale_y_continuous(limits = c(1600000, 5200000)) +
  theme_void() +
  labs(title="Internet access by region in 2014")
```
:::

<div>

```{r}
int_acc_map_reg_22 <- reg_int_access |>
  filter(Year=="2022") |>
  full_join(map_reg, by=join_by(REG_ID)) |>
  st_as_sf()
```

```{r regional_internet_access_map_2022}
int_acc_map_reg_22 |>
  ggplot(aes(fill = Value)) +
  geom_sf(size = 0.2) +
  scale_fill_distiller(
    direction = 1, 
    name = "%",
    na.value = "gray80",
    limits=c(40, 100)) + 
  scale_x_continuous(limits = c(2500000, 7000000)) +
  scale_y_continuous(limits = c(1600000, 5200000)) +
  theme_void() +
  labs(title="Internet access by region in 2022")
```

</div>
:::

### Sweden

As one of the top 5 countries in terms of internet access, Swedish regional data shows an overall stability with all regions remaining at above 80% of households having access; however, year on year changes are seemingly random and volatile. For example, Upper Norrland (SE32) went from a 100% access in 2020 to 82% in 2022. This may be due to the significant internal migration[^1], leaving households with no need for internet access; or conversely, positive net migration for education or work, such as in metropolitan regions like Stockholm (SE11) or West Sweden (SE23), result in a less volatile pattern than regions with a negative net migration.

[^1]: <https://www.scb.se/en/finding-statistics/statistics-by-subject-area/population/population-projections/demographic-analysis-demog/pong/statistical-news/demographic-analysis-internal-migration-in-sweden-moving-between-counties-20022021/>

```{r}
reg_int_access |>
  mutate(Year = factor(Year)) |>
  filter(str_detect(REG_ID, "SE")) |>
  ggplot(aes(x= Year, y=Value, group = REG_ID, color = REG_ID))+
  geom_line() +
  labs(
    title = "Internet Access in Swedish Regions over Time",
    x = "Year",
    y = "% of Households with Internet Access"
  )
```


## Broadband access

Broadband refers to any infrastructure for high-speed internet access. According to the Europe 2020 strategy[^2], the European Union (EU) articulated three broadband-related targets in 2010:

[^2]: <https://www.eca.europa.eu/Lists/ECADocuments/SR18_12/SR_BROADBAND_EN.pdf>

-   extend basic broadband (up to 30 Megabits per second, Mbps) accessibility to all Europeans by 2013.

-   provide fast broadband (exceeding 30 Mbps) to all Europeans by the year 2020.

-   ensure that 50% or more of European households adopted ultra-fast broadband (surpassing 100 Mbps) by 2020.

We review the progress by comparing broadband access in 2013 and 2022 at both more than 30 Mbps and more than 100 Mbps. The observation is the percentage of households with more than the targeted speed coverage.

### Country level

We can see that only the few member states achieved the first target of basic broadband. Countries with close to 100% with at 30 Mbps were Malta, Switzerland, Netherlands, Belgium, Luxembourg. Countries with less than 40% households with at Mbps broadband access were Greece, Italy, Croatia, Romania and France.

The situation is clearly improved in the 2022, as all the observed EU member states have more the 75% households with broadband access at more than 30 Mbps.

```{r}
#| message: false
map_co <- get_eurostat_geospatial(resolution = 10, 
                        nuts_level = 0, 
                        year = 2016)
map_co <- map_co |>
  select(id, NAME_LATN) |>
  rename(REG_ID = id) 
map_eu <- map_co |>
  inner_join(country_ids, by = join_by(REG_ID)) |>
  select(REG_ID, geometry)
```

```{r}
bb_map_co_22 <- co_broadband |>
  inner_join(map_eu, by = join_by(REG_ID)) |>
  filter(Year=="2022") |>
  select(-GBPS_GT1, -MBPS_GT2, -MBPS_GT100, -Year) |>
  st_as_sf()


bb_map_co_13 <- co_broadband |>
  inner_join(map_eu, by = join_by(REG_ID)) |>
  filter(Year=="2013") |>
  select(-GBPS_GT1, -MBPS_GT2, -MBPS_GT100, -Year) |>
  st_as_sf()
```

::: {layout-ncol="2"}
::: {#2013}
```{r country_broadband_map_2013}
bb_map_co_13 |>
  ggplot(aes(fill=MBPS_GT30)) +
  geom_sf(size = 0.2, color = "#F3F3F3",
          position = "dodge") +
  scale_fill_viridis_c(
    direction = -1,
    name = "%",
    na.value = "gray80",
    limits=c(10, 100)) + 
  scale_x_continuous(limits = c(-10, 35)) +
  scale_y_continuous(limits = c(35, 65)) +
  theme_void() +
  labs(title = "Broadband access by country at 30Mbps:",
       subtitle = "in 2013")
```
:::

::: {#2020}
```{r country_broadband_map_2022}
bb_map_co_22 |>
  ggplot(aes(fill=MBPS_GT30)) +
  geom_sf(size = 0.2, color = "#F3F3F3") +
  scale_fill_viridis_c(
    direction = -1,
    name = "%",
    na.value = "gray80",
    limits=c(10, 100)) + 
  scale_x_continuous(limits = c(-10, 35)) +
  scale_y_continuous(limits = c(35, 65)) +
  theme_void() +
  labs(title = "Broadband access by country at 30Mbps:",
       subtitle = "in 2022")
```
:::
:::

According to our data, the third target of ultra-fast broadband was not achieved by 2020 as countries such as Croatia and Greece had less than 50% households, but the situation is highly improved by 2022. All the observed states have more than 60% of the households with ultra-fast broadband. Top performing states are again Malta, Switzerland, Netherlands, Belgium, Denmark. Countries like Portugal (94.9%), Romania (94.5%) and Norway (93.6%) increased the coverage significantly. The lowest performing are United Kingdom(69.8%), Greece (67.4%) and Croatia (63.9%).

```{r}
bb_map_co_22_100 <- co_broadband |>
  inner_join(map_eu, by = join_by(REG_ID)) |>
  filter(Year=="2022") |>
  select(-GBPS_GT1, -MBPS_GT2, -MBPS_GT30, -Year) |>
  st_as_sf()


bb_map_co_13_100 <- co_broadband |>
  inner_join(map_eu, by = join_by(REG_ID)) |>
  filter(Year=="2013") |>
  select(-GBPS_GT1, -MBPS_GT2, -MBPS_GT30, -Year) |>
  st_as_sf()
```

::: {layout-ncol="2"}
<div>

```{r country_broadband_map_2013_100mbps}
bb_map_co_13_100 |>
  ggplot(aes(fill=MBPS_GT100)) +
  geom_sf(size = 0.2, color = "#F3F3F3",
          position = "dodge") +
  scale_fill_viridis_c(
    direction = -1,
    name = "%",
    na.value = "gray80",
    limits=c(0, 100)) + 
  scale_x_continuous(limits = c(-10, 35)) +
  scale_y_continuous(limits = c(35, 65)) +
  theme_void() +
  labs(title = "Broadband access by country at 100Mbps:",
       subtitle = "in 2013")
```

</div>

<div>

```{r country_broadband_map_2022_100mbps}
bb_map_co_22_100 |>
  ggplot(aes(fill=MBPS_GT100)) +
  geom_sf(size = 0.2, color = "#F3F3F3") +
  scale_fill_viridis_c(
    direction = -1,
    name = "%",
    na.value = "gray80",
    limits=c(0, 100)) + 
  scale_x_continuous(limits = c(-10, 35)) +
  scale_y_continuous(limits = c(35, 65)) +
  theme_void() +
  labs(title = "Broadband access by country at 100Mbps:",
       subtitle = "in 2022")
```

</div>
:::

### Regional level: Austria

```{r}
bb_reg <- reg_broadband |>
  filter(str_detect(REG_ID, "AT"))

ggplot(bb_reg, aes(x = Year, y = Value, color = REG_ID)) +
  geom_line()
```

## Usage

### Shopping: Netherlands

```{r}
employed <- co_usage[["int_emp"]] |>
  select(indic_is, REG_ID, Year, SAL_SELF_FAM) |>
  filter(indic_is %in% c("I_IUIF", "I_IUSELL"), REG_ID == "NL") |>
  pivot_wider(names_from = indic_is, values_from = SAL_SELF_FAM)
```

```{r}
shop_pattern <- co_house_access |>
  filter(REG_ID == "NL") |>
  inner_join(employed, by = c("REG_ID", "Year"))
```

```{r}
model <- lm(Value ~ I_IUIF + I_IUSELL, data =shop_pattern)
summary(model)
```

-   R-squared is 0.8186, 81.86% of the variability in Value explained by the model.
-   Significant positive relationship between I_IUIF and Value.
-   I_IUSELL is not significant.

```{r}
confint(model)
```

-   The interval for I_IUIF does not include zero, indicating statistical significance.
-   The interval for I_IUSELL includes zero, suggesting a lack of statistical significance.

```{r}
#| message: false
ggplot(model, aes(x = I_IUSELL, y = I_IUIF)) +
  geom_point() + 
  geom_smooth(method = "loess")+
  labs(x = "I_IUSELL", y = "I_IUIF")
```

### Shopping: Regional level

These maps illustrate the evolution of internet shopping behavior across regions, providing insights into the changing trends in online commerce.


```{r}
shop_reg_14 <- reg_shopping |>
  filter(Year=="2014") |>
  full_join(map_reg, by=join_by(REG_ID)) |>
  st_as_sf()
shop_reg_21 <- reg_shopping |>
  filter(Year=="2021") |>
  full_join(map_reg, by=join_by(REG_ID)) |>
  st_as_sf()
```

::: {layout-ncol="2"}
::: {#2014}
```{r regional_shop_map_14}
shop_reg_14 |>
  ggplot(aes(fill = Value)) +
  geom_sf(size = 0.2) +
  scale_fill_distiller(
    direction = 1, 
    name = "%",
    na.value = "gray80",
    limits=c(0, 100)) + 
  scale_x_continuous(limits = c(2500000, 7000000)) +
  scale_y_continuous(limits = c(1600000, 5200000)) +
  theme_void() +
  labs(title="Internet shopping by region in 2014")
```
:::

::: {2021}
```{r regional_shopping_map_21}
shop_reg_21 |>
  ggplot(aes(fill = Value)) +
  geom_sf(size = 0.2) +
  scale_fill_distiller(
    direction = 1, 
    name = "%",
    na.value = "gray80",
    limits=c(0, 100)) + 
  scale_x_continuous(limits = c(2500000, 7000000)) +
  scale_y_continuous(limits = c(1600000, 5200000)) +
  theme_void() +
  labs(title="Internet shopping by region in 2021")
```
:::
:::

### Hungary

There is a clear increase in internet usage across most types.

```{r}
aa <- co_usage[["internet"]] |>
  filter(Year==c(2019, 2022)) |>
  filter(REG_ID=="HU")
ggplot(aa, aes(x= indic_is, y=Value, 
               fill = as.factor(Year))) +
  geom_col(position = "dodge") +
  scale_fill_discrete(name = "Year") +
  labs(y = "%", x = "Indicator type", 
       title = "Internet usage by type in 2019 and 2022, Hungary")+
  theme(axis.text.x = element_text(angle=90))
```


### Employment status

On average, across all European countries, students dominate the proportion of internet usage across almost all areas with, for example, 100% of students using the internet for instant messaging (I_IUCHAT1) and watching internet streamed TV or videos (I_IUSTVV).
Retired individuals are consistently the lowest proportion, only surprassing the unemployed through using the internet for online banking.

```{r}
zz <- co_usage[["internet"]] |>
  filter(ind_type==c("RETIR_OTHER", "SAL_SELF_FAM", 
                     "STUD", "UNE")) |>
  filter(Year=="2022")
```

```{r}
ggplot(zz, aes(x = indic_is, y=Value, 
               fill = ind_type)) +
  geom_col(position = "dodge") +
  scale_fill_discrete(name = "Employment status") +
  labs(y = "%", x = "Indicator type", 
       title = "Internet usage by Employment in 2022")+
  theme(axis.text.x = element_text(angle=90))
```

```{r}
ggplot(zz, aes(x = indic_is, y=Value, 
               fill = ind_type)) +
  geom_col(position = "dodge") +
  scale_fill_discrete(name = "Employment status") +
  labs(y = "%", x = "Indicator type", 
       title = "Internet usage by Employment in 2022")+
  theme(axis.text.x = element_text(angle=90)) +
  facet_wrap(~ind_type)
```


### Social Network: Cyprus

This plot compares employment-wise usage for *participating in social networks (creating user profile, posting messages or other contributions to facebook, twitter, etc.)* over 2014-22. There is a visible increase in usage made by retired, self employed, and unemployed individuals, and a steady rate maintained by students.

```{r}
emp <- co_usage[["internet"]] |>
  filter(ind_type==c("RETIR_OTHER", "SAL_SELF_FAM", 
                     "STUD", "UNE")) |>
  filter(REG_ID=="CY") |>
  filter(indic_is=="I_IUSNET")
emp |>
  ggplot(aes(x = Year, y=Value, color = ind_type)) +
  geom_line() +
  labs(y = "%", title = "Participating in social networks in Cyprus by employment status")
```

### Playing or downloading games: Italy
::: {layout-ncol="2"}
::: {#fem}
```{r}
fm_cy <- co_usage[["int_female"]] |>
  pivot_longer(cols = 4:8, names_to = "Ages") |>
  filter(indic_is == "I_IUPDG", REG_ID == "IT") |>
  mutate(Year = factor(Year))
  
fm_cy |>
  ggplot(aes(x = Year, y=value, group = Ages, color = Ages)) +
  geom_line(na.rm=TRUE) +
  labs(y = "%", title = "Playing or downloading games in Italy by Age - Female" ) +
  xlim("2018", "2019", "2020", "2021", "2022") +
  ylim(c(0, 100))
```
:::

::: {#mal}
```{r}
m_cy <- co_usage[["int_male"]] |>
  pivot_longer(cols = 4:8, names_to = "Ages") |>
  filter(indic_is == "I_IUPDG", REG_ID == "CY") |>
  mutate(Year = factor(Year))
  
m_cy |>
  ggplot(aes(x = Year, y=value, group = Ages, color = Ages)) +
  geom_line(na.rm=TRUE) +
  labs(y = "%", title = "Playing or downloading games in Italy by Age - Male" ) +
  xlim("2018", "2019", "2020", "2021", "2022") +
  ylim(c(0, 100))
```
:::
:::

### Seeking health information: Albania

The plots below focus on the internet usage behavior in Albania, particularly in seeking health information, segmented by different age groups and gender. The increase in seeking health information on the internet around 2020 can be attributed to the Covid-19 pandemic, and the decline in the trend in 2022 implies the end of the perceived threat of the virus.

::: {layout-ncol="2"}
::: {#female}
```{r}
co_usage[["int_female"]] |>
  pivot_longer(cols = 4:8, names_to = "Ages") |>
  filter(indic_is == "I_IHIF", REG_ID == "AL") |>
  mutate(Year = factor(Year)) |>
  ggplot(aes(x= Year, y=value, group=Ages, color=Ages))+
  geom_line(linewidth=0.5)+
  ylim(c(10, 75)) +
  labs(
    title = "Seeking Health information on the internet in Albania by Age: Female ",
    x = "Year",
    y = "% of Females")
```
:::

::: {#male}
```{r}
co_usage[["int_male"]] |>
  pivot_longer(cols = 4:8, names_to = "Ages") |>
  filter(indic_is == "I_IHIF", REG_ID == "AL") |>
  mutate(Year = factor(Year)) |>
  ggplot(aes(x= Year, y=value, group=Ages, color=Ages))+
  geom_line(linewidth=0.5)+
  ylim(c(10, 75)) +
  labs(
    title = "Seeking Health information on the internet in Albania by Age: Male ",
    x = "Year",
    y = "% of Males")
```
:::
:::


### Online course: France

This plot compares gender-wise usage for *doing an online course* by for individuals aged 16 to 24 over 2011-22. While we see a steady growth in the percentage of individuals doing an online course, the female (blue) population has surpassed male (red) users. This can be interpreted as an increase in access among homemakers.

```{r}
co_usage[["int_wide"]] |>
    select(indic_is, REG_ID, Year, F_Y16_24, M_Y16_24) |>
    filter(indic_is == "I_IUOLC", REG_ID == "FR") |>
ggplot(aes(x = Year)) +
  geom_line(aes(y = F_Y16_24), color = "blue", linetype = "solid") +
  geom_line(aes(y = M_Y16_24), color = "brown", linetype = "solid") +
  ylab("Count") +
  xlab("Year") +
  ggtitle("Online course by Gender (Age 16-24) in France")
```

# Conclusion

This report undertook a thorough analysis into the internet usage patterns across European Union member states, shedding light on various dimensions such as health information seeking and online learning.

The findings of this study underscore significant improvements in internet access and broadband coverage over the past twelve years among European Union member states. While some nations met the initial 2010 targets for basic broadband accessibility, others demonstrated substantial progress, marking a notable shift towards fast and ultra-fast broadband. The surge in households exceeding 30 Mbps and 100 Mbps illustrates the transformative trajectory of digital connectivity. Regional analysis highlights dynamic shifts in internet access patterns, particularly evident in regions like North West Belgium and specific areas in Romania, emphasizing the importance of considering regional nuances in comprehending the evolving digital landscape. The positive trends at both country and regional levels reflect collective efforts and advancements in digital infrastructure and literacy initiatives.

Luxembourg, the Netherlands, and Denmark emerge as front-runners.

# Appendix

## Links

### Git

Git-hub Project: [G11-Internet-Usage](https://github.com/khushiijain/G11-Internet-Usage)

### Data Sources

[Households that have internet access at home by NUTS 2 regions:]{.underline} [reg_int_access](https://ec.europa.eu/eurostat/databrowser/view/tgs00047/default/table?lang=en)

[Individuals who ordered goods or services over the internet for private use in the last year by NUTS 2 regions:]{.underline} [reg_shopping](https://ec.europa.eu/eurostat/databrowser/view/tgs00052/default/map?lang=en)

[Individuals regularly using the internet by NUTS 2 regions:]{.underline} [red_int_use](https://ec.europa.eu/eurostat/databrowser/view/tgs00050/default/table?lang=en)

[Regional Social and Environmental indicators: Internet broadband access:]{.underline}

Website reach: Regional Demography -\> Regional Social and Environmental indicators -\> Internet broadband access: [reg_broadband](https://stats.oecd.org/Index.aspx?DataSetCode=REGION_DEMOGR#)

The data is available for many countries and we selected 29 European countries. To filter on the OECD website, we must go to the ***Customise*** -\> ***Selection*** -\> ***Region*** and select the 29 countries and their regions.

[Individuals - internet activities:]{.underline} [co_usage](https://ec.europa.eu/eurostat/databrowser/view/ISOC_CI_AC_I__custom_8519721/default/table?lang=en&page=time:2022)

[Broadband internet coverage by speed]{.underline}: [co_broadband](https://ec.europa.eu/eurostat/databrowser/view/isoc_cbs__custom_8519699/default/table?lang=en)

[Level of internet access - households]{.underline}: [co_house_access](https://ec.europa.eu/eurostat/databrowser/view/tin00134__custom_8520113/default/table?lang=en)

## Cleaning

For ease of cleaning, multiple functions have been created.

### Formatting OECD data

A code removes the unnecessary columns, leaving the OECD regional broadband access data to consist of the Regional ID, Year, and percentage Value.

### Formatting Eurostat regional data

Data for regional "Individual regular internet use", "Internet access", and "Goods and services shopping" also now contain only the Regional ID, Year, and Value variables.

### Formatting Eurostat country data

Reformatting is done, same as previously, for country level Internet access.

Country level broadband access speed is reformatted and pivoted to display the different speeds as additional variables

#### Formatting Eurostat full internet usage dataset by country

First, a function is created to split the dataset into comprehensible country, indicator, and individual type codes, as well as removal of unnecessary columns. Then, pivoting the data allows for further separation by Sex and Employment status. All these datasets are placed in a list.
